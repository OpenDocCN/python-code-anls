# `.\yolov8\ultralytics\models\nas\val.py`

```
# Ultralytics YOLO ğŸš€, AGPL-3.0 license

import torch  # å¯¼å…¥PyTorchåº“

from ultralytics.models.yolo.detect import DetectionValidator  # å¯¼å…¥æ£€æµ‹éªŒè¯å™¨ç±»
from ultralytics.utils import ops  # å¯¼å…¥å·¥å…·å‡½æ•°

__all__ = ["NASValidator"]  # å®šä¹‰æ¨¡å—çš„å…¬å¼€æ¥å£ï¼ŒåªåŒ…å«NASValidatorç±»

class NASValidator(DetectionValidator):
    """
    Ultralytics YOLO NAS Validator for object detection.

    Extends `DetectionValidator` from the Ultralytics models package and is designed to post-process the raw predictions
    generated by YOLO NAS models. It performs non-maximum suppression to remove overlapping and low-confidence boxes,
    ultimately producing the final detections.

    Attributes:
        args (Namespace): Namespace containing various configurations for post-processing, such as confidence and IoU.
        lb (torch.Tensor): Optional tensor for multilabel NMS.

    Example:
        ```py
        from ultralytics import NAS

        model = NAS('yolo_nas_s')
        validator = model.validator
        # Assumes that raw_preds are available
        final_preds = validator.postprocess(raw_preds)
        ```

    Note:
        This class is generally not instantiated directly but is used internally within the `NAS` class.
    """

    def postprocess(self, preds_in):
        """Apply Non-maximum suppression to prediction outputs."""
        # å°†é¢„æµ‹æ¡†æ ¼å¼è½¬æ¢ä¸ºä¸­å¿ƒå®½é«˜æ ¼å¼
        boxes = ops.xyxy2xywh(preds_in[0][0])
        # å°†é¢„æµ‹ç»“æœä¸æ¡†çš„åæ ‡ä¿¡æ¯åˆå¹¶ï¼Œå¹¶å¯¹ç»´åº¦è¿›è¡Œè°ƒæ•´
        preds = torch.cat((boxes, preds_in[0][1]), -1).permute(0, 2, 1)
        # æ‰§è¡Œéæå¤§å€¼æŠ‘åˆ¶ï¼Œç­›é€‰å‡ºæœ€ç»ˆçš„æ£€æµ‹ç»“æœ
        return ops.non_max_suppression(
            preds,
            self.args.conf,  # ç½®ä¿¡åº¦é˜ˆå€¼
            self.args.iou,   # IoU é˜ˆå€¼
            labels=self.lb,  # å¤šæ ‡ç­¾NMSçš„æ ‡ç­¾å¼ é‡ï¼Œå¯é€‰
            multi_label=False,  # æ˜¯å¦è¿›è¡Œå¤šæ ‡ç­¾NMS
            agnostic=self.args.single_cls,  # æ˜¯å¦è¿›è¡Œç±»åˆ«æ— å…³çš„NMS
            max_det=self.args.max_det,  # æœ€å¤§æ£€æµ‹æ•°ç›®
            max_time_img=0.5,  # æœ€å¤§å¤„ç†æ—¶é—´
        )
```