# `D:\src\scipysrc\sympy\sympy\testing\tmpfiles.py`

```
"""
This module adds context manager for temporary files generated by the tests.
"""

# 引入 shutil 和 os 模块
import shutil
import os

# 定义一个管理临时文件和文件夹的类
class TmpFileManager:
    """
    A class to track record of every temporary files created by the tests.
    """
    # 类变量，用于存储临时文件名集合和临时文件夹名集合
    tmp_files = set('')
    tmp_folders = set('')

    @classmethod
    def tmp_file(cls, name=''):
        # 将指定的临时文件名添加到 tmp_files 集合中
        cls.tmp_files.add(name)
        return name

    @classmethod
    def tmp_folder(cls, name=''):
        # 将指定的临时文件夹名添加到 tmp_folders 集合中
        cls.tmp_folders.add(name)
        return name

    @classmethod
    def cleanup(cls):
        # 清理临时文件和临时文件夹
        while cls.tmp_files:
            # 从 tmp_files 中弹出一个临时文件名
            file = cls.tmp_files.pop()
            if os.path.isfile(file):  # 如果是文件
                # 删除该文件
                os.remove(file)
        while cls.tmp_folders:
            # 从 tmp_folders 中弹出一个临时文件夹名
            folder = cls.tmp_folders.pop()
            # 递归删除该文件夹及其内容
            shutil.rmtree(folder)

# 定义一个装饰器函数，用于在测试完成后清理临时文件
def cleanup_tmp_files(test_func):
    """
    A decorator to help test codes remove temporary files after the tests.
    """
    def wrapper_function():
        try:
            # 执行测试函数
            test_func()
        finally:
            # 在 finally 块中调用临时文件管理类的 cleanup 方法清理临时文件
            TmpFileManager.cleanup()

    return wrapper_function
```