# `D:\src\scipysrc\scikit-learn\examples\mixture\plot_gmm_init.py`

```
"""
==========================
GMM Initialization Methods
==========================

Examples of the different methods of initialization in Gaussian Mixture Models

See :ref:`gmm` for more information on the estimator.

Here we generate some sample data with four easy to identify clusters. The
purpose of this example is to show the four different methods for the
initialization parameter *init_param*.

The four initializations are *kmeans* (default), *random*, *random_from_data* and
*k-means++*.

Orange diamonds represent the initialization centers for the gmm generated by
the *init_param*. The rest of the data is represented as crosses and the
colouring represents the eventual associated classification after the GMM has
finished.

The numbers in the top right of each subplot represent the number of
iterations taken for the GaussianMixture to converge and the relative time
taken for the initialization part of the algorithm to run. The shorter
initialization times tend to have a greater number of iterations to converge.

The initialization time is the ratio of the time taken for that method versus
the time taken for the default *kmeans* method. As you can see all three
alternative methods take less time to initialize when compared to *kmeans*.

In this example, when initialized with *random_from_data* or *random* the model takes
more iterations to converge. Here *k-means++* does a good job of both low
time to initialize and low number of GaussianMixture iterations to converge.
"""

# Author: Gordon Walsh <gordon.p.walsh@gmail.com>
# Data generation code from Jake Vanderplas <vanderplas@astro.washington.edu>

from timeit import default_timer as timer

import matplotlib.pyplot as plt
import numpy as np

from sklearn.datasets._samples_generator import make_blobs
from sklearn.mixture import GaussianMixture
from sklearn.utils.extmath import row_norms

print(__doc__)

# Generate some data

X, y_true = make_blobs(n_samples=4000, centers=4, cluster_std=0.60, random_state=0)
X = X[:, ::-1]

n_samples = 4000
n_components = 4
x_squared_norms = row_norms(X, squared=True)


def get_initial_means(X, init_params, r):
    # Run a GaussianMixture with max_iter=0 to output the initialization means
    gmm = GaussianMixture(
        n_components=4, init_params=init_params, tol=1e-9, max_iter=0, random_state=r
    ).fit(X)
    return gmm.means_

methods = ["kmeans", "random_from_data", "k-means++", "random"]
colors = ["navy", "turquoise", "cornflowerblue", "darkorange"]
times_init = {}
relative_times = {}

plt.figure(figsize=(4 * len(methods) // 2, 6))
plt.subplots_adjust(
    bottom=0.1, top=0.9, hspace=0.15, wspace=0.05, left=0.05, right=0.95
)

for n, method in enumerate(methods):
    r = np.random.RandomState(seed=1234)
    # Create subplots for each initialization method
    plt.subplot(2, len(methods) // 2, n + 1)

    start = timer()
    # Obtain initial means using GaussianMixture with specified initialization method
    ini = get_initial_means(X, method, r)
    end = timer()
    init_time = end - start  # Calculate initialization time
    # 使用高斯混合模型对数据 X 进行拟合，设置参数包括：组件数为4，初始均值为 ini，容差为1e-9，最大迭代次数为2000，随机状态为 r
    gmm = GaussianMixture(
        n_components=4, means_init=ini, tol=1e-9, max_iter=2000, random_state=r
    ).fit(X)

    # 将初始化时间记录到 times_init 字典中，键为方法名 method，值为 init_time
    times_init[method] = init_time

    # 遍历颜色列表，并根据每个组件的预测结果绘制散点图
    for i, color in enumerate(colors):
        # 选择数据 X 中预测为第 i 个组件的样本数据
        data = X[gmm.predict(X) == i]
        # 绘制散点图，X 轴为数据的第一列，Y 轴为数据的第二列，颜色为 color，标记为 "x"
        plt.scatter(data[:, 0], data[:, 1], color=color, marker="x")

    # 绘制初始均值点的散点图，标记为 "D"，大小为75，颜色为橙色，边界颜色为黑色，位置为 ini 的第一列和第二列
    plt.scatter(
        ini[:, 0], ini[:, 1], s=75, marker="D", c="orange", lw=1.5, edgecolors="black"
    )

    # 计算相对初始化时间比例，存储到 relative_times 字典中，方法为 method 对应的时间除以 methods 列表中第一个方法的时间
    relative_times[method] = times_init[method] / times_init[methods[0]]

    # 设置 X 轴和 Y 轴无刻度
    plt.xticks(())
    plt.yticks(())

    # 设置左侧标题为方法名 method，字体大小为12
    plt.title(method, loc="left", fontsize=12)
    
    # 设置右侧标题，显示迭代次数和初始化时间比例，迭代次数为 gmm.n_iter_，时间比例为 relative_times[method]，字体大小为10
    plt.title(
        "Iter %i | Init Time %.2fx" % (gmm.n_iter_, relative_times[method]),
        loc="right",
        fontsize=10,
    )
# 设置整个图表的标题为 "GMM iterations and relative time taken to initialize"
plt.suptitle("GMM iterations and relative time taken to initialize")
# 显示整个图表，如果没有之前的plt.figure()或者子图的定义，将显示一个默认的图
plt.show()
```