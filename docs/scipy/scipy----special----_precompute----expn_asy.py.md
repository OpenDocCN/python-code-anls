# `D:\src\scipysrc\scipy\scipy\special\_precompute\expn_asy.py`

```
"""Precompute the polynomials for the asymptotic expansion of the
generalized exponential integral.

Sources
-------
[1] NIST, Digital Library of Mathematical Functions,
    https://dlmf.nist.gov/8.20#ii

"""
# 导入操作系统模块
import os

# 尝试导入 sympy 库，并从中导入 Poly 类和 symbols 函数
try:
    import sympy
    from sympy import Poly
    # 创建符号变量 x
    x = sympy.symbols('x')
except ImportError:
    pass


# 定义函数 generate_A，用于生成指定阶数的多项式列表
def generate_A(K):
    # 初始多项式列表 A 包含一个 Poly(1, x) 对象
    A = [Poly(1, x)]
    # 循环生成 K 阶的多项式
    for k in range(K):
        # 生成当前阶数的多项式，并添加到列表 A 中
        A.append(Poly(1 - 2*k*x, x)*A[k] + Poly(x*(x + 1))*A[k].diff())
    return A


# 定义警告信息字符串
WARNING = """\
/* This file was automatically generated by _precompute/expn_asy.py.
 * Do not edit it manually!
 */
"""


# 主函数，执行主要的预处理工作
def main():
    # 打印文件头部的文档字符串
    print(__doc__)
    # 定义目标文件名 fn，并设置相对路径
    fn = os.path.join('..', 'cephes', 'expn.h')

    # 设定多项式阶数 K
    K = 12
    # 生成多项式列表 A
    A = generate_A(K)
    
    # 打开一个新文件 fn.new，准备写入预处理数据
    with open(fn + '.new', 'w') as f:
        # 写入警告信息
        f.write(WARNING)
        # 写入宏定义，指定 A 的长度
        f.write(f"#define nA {len(A)}\n")
        # 遍历多项式列表 A，并将每个多项式的系数转换为字符串写入文件
        for k, Ak in enumerate(A):
            ', '.join([str(x.evalf(18)) for x in Ak.coeffs()])
            f.write(f"static const double A{k}[] = {{tmp}};\n")
        # 写入指向多项式数组 A 的指针数组声明
        ", ".join([f"A{k}" for k in range(K + 1)])
        f.write("static const double *A[] = {{tmp}};\n")
        # 写入每个多项式的阶数列表
        ", ".join([str(Ak.degree()) for Ak in A])
        f.write("static const int Adegs[] = {{tmp}};\n")
    
    # 将新生成的文件重命名为原始文件名 fn
    os.rename(fn + '.new', fn)


# 如果当前脚本作为主程序运行，则调用主函数 main()
if __name__ == "__main__":
    main()
```